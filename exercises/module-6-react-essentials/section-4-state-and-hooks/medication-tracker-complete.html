<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medication Tracker with State - Complete</title>
    <!-- React and ReactDOM development scripts -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX support -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        .container {
            margin-top: 30px;
        }
        
        h1, h2 {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .instructions {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin-bottom: 20px;
        }

        .medication-form {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0069d9;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-controls button {
            background-color: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .filter-controls button.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .medication-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .medication-item h3 {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .medication-item p {
            margin: 5px 0;
        }

        .medication-item .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .status-active {
            color: #28a745;
            font-weight: bold;
        }
        
        .status-inactive {
            color: #6c757d;
            font-style: italic;
        }

        .delete-button {
            background-color: #dc3545;
        }

        .delete-button:hover {
            background-color: #c82333;
        }
        
        .tabs {
            display: flex;
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tabs li {
            margin-right: 10px;
            padding: 8px 16px;
            cursor: pointer;
        }
        
        .tabs li.active {
            border-bottom: 3px solid #007bff;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // Import React hooks
        const { useState, useReducer, useEffect } = React;
        
        // 1. MEDICATION FORM COMPONENT
        function MedicationForm({ onAddMedication }) {
            // State for form inputs
            const [formData, setFormData] = useState({
                name: '',
                dosage: '',
                schedule: 'Daily'
            });
            
            // Handle input changes
            const handleChange = (field, value) => {
                setFormData({
                    ...formData,
                    [field]: value
                });
            };
            
            // Handle form submission
            const handleSubmit = (e) => {
                e.preventDefault();
                
                // Validate form
                if (!formData.name || !formData.dosage) {
                    alert('Please fill out all required fields.');
                    return;
                }
                
                // Generate a unique ID
                const newMedication = {
                    id: Date.now().toString(),
                    ...formData,
                    isActive: true,
                    lastTaken: null
                };
                
                onAddMedication(newMedication);
                
                // Reset form
                setFormData({
                    name: '',
                    dosage: '',
                    schedule: 'Daily'
                });
            };
            
            return (
                <div className="medication-form">
                    <h2>Add New Medication</h2>
                    <form onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label htmlFor="name">Medication Name:</label>
                            <input
                                type="text"
                                id="name"
                                value={formData.name}
                                onChange={(e) => handleChange('name', e.target.value)}
                                placeholder="Enter medication name"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label htmlFor="dosage">Dosage:</label>
                            <input
                                type="text"
                                id="dosage"
                                value={formData.dosage}
                                onChange={(e) => handleChange('dosage', e.target.value)}
                                placeholder="Enter dosage (e.g., 10mg)"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label htmlFor="schedule">Schedule:</label>
                            <select
                                id="schedule"
                                value={formData.schedule}
                                onChange={(e) => handleChange('schedule', e.target.value)}
                            >
                                <option value="Daily">Daily</option>
                                <option value="Twice daily">Twice daily</option>
                                <option value="Three times daily">Three times daily</option>
                                <option value="As needed">As needed</option>
                                <option value="Weekly">Weekly</option>
                            </select>
                        </div>
                        
                        <button type="submit">Add Medication</button>
                    </form>
                </div>
            );
        }
        
        // 2. MEDICATION ITEM COMPONENT
        function MedicationItem({ medication, onToggleStatus, onDelete }) {
            // Format date helper
            const formatDate = (dateString) => {
                if (!dateString) return 'Never';
                
                const date = new Date(dateString);
                return date.toLocaleString();
            };
            
            return (
                <div className="medication-item">
                    <h3>{medication.name}</h3>
                    <p>Dosage: {medication.dosage}</p>
                    <p>Schedule: {medication.schedule}</p>
                    <p>Status: <span className={medication.isActive ? 'status-active' : 'status-inactive'}>
                        {medication.isActive ? 'Active' : 'Inactive'}
                    </span></p>
                    <p>Last Taken: {formatDate(medication.lastTaken)}</p>
                    
                    <div className="actions">
                        <button onClick={() => onToggleStatus(medication.id)}>
                            {medication.isActive ? 'Mark as Taken' : 'Mark as Active'}
                        </button>
                        <button 
                            className="delete-button" 
                            onClick={() => onDelete(medication.id)}
                        >
                            Delete
                        </button>
                    </div>
                </div>
            );
        }
        
        // 3. FILTER CONTROLS COMPONENT
        function FilterControls({ activeFilter, onFilterChange }) {
            return (
                <div className="filter-controls">
                    <button 
                        className={activeFilter === 'all' ? 'active' : ''}
                        onClick={() => onFilterChange('all')}
                    >
                        All
                    </button>
                    <button 
                        className={activeFilter === 'active' ? 'active' : ''}
                        onClick={() => onFilterChange('active')}
                    >
                        Active
                    </button>
                    <button 
                        className={activeFilter === 'taken' ? 'active' : ''}
                        onClick={() => onFilterChange('taken')}
                    >
                        Taken
                    </button>
                </div>
            );
        }
        
        // 4. MEDICATION TRACKER COMPONENT (Main Component)
        function MedicationTracker() {
            // State for the medication list
            const [medications, setMedications] = useState([
                {
                    id: '1',
                    name: 'Lisinopril',
                    dosage: '10mg',
                    schedule: 'Daily',
                    isActive: true,
                    lastTaken: null
                },
                {
                    id: '2',
                    name: 'Metformin',
                    dosage: '500mg',
                    schedule: 'Twice daily',
                    isActive: true,
                    lastTaken: null
                },
                {
                    id: '3',
                    name: 'Vitamin D',
                    dosage: '1000 IU',
                    schedule: 'Daily',
                    isActive: false,
                    lastTaken: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() // 1 day ago
                }
            ]);
            
            // State for the active filter
            const [filter, setFilter] = useState('all'); // 'all', 'active', 'taken'
            
            // Add a new medication
            const addMedication = (medication) => {
                setMedications([...medications, medication]);
            };
            
            // Toggle a medication's status
            const toggleMedicationStatus = (id) => {
                setMedications(medications.map(med => {
                    if (med.id === id) {
                        return {
                            ...med,
                            isActive: !med.isActive,
                            lastTaken: !med.isActive ? null : new Date().toISOString()
                        };
                    }
                    return med;
                }));
            };
            
            // Delete a medication
            const deleteMedication = (id) => {
                if (confirm('Are you sure you want to delete this medication?')) {
                    setMedications(medications.filter(med => med.id !== id));
                }
            };
            
            // Get filtered medications
            const getFilteredMedications = () => {
                switch (filter) {
                    case 'active':
                        return medications.filter(med => med.isActive);
                    case 'taken':
                        return medications.filter(med => !med.isActive);
                    default:
                        return medications;
                }
            };
            
            const filteredMedications = getFilteredMedications();
            
            return (
                <div className="container">
                    <h1>Medication Tracker</h1>
                    
                    <div className="instructions">
                        <h3>Exercise: Medication Tracker with State (Completed)</h3>
                        <p>This application demonstrates state management in React using the useState hook.</p>
                        <p>Key features implemented:</p>
                        <ul>
                            <li>Form state with controlled inputs</li>
                            <li>List state with add, toggle, and delete operations</li>
                            <li>Filter state for different views</li>
                            <li>State updates with immutable patterns</li>
                        </ul>
                    </div>
                    
                    <MedicationForm onAddMedication={addMedication} />
                    
                    <h2>Your Medications</h2>
                    <FilterControls 
                        activeFilter={filter} 
                        onFilterChange={setFilter} 
                    />
                    
                    <div className="medication-list">
                        {filteredMedications.length === 0 ? (
                            <p>No medications found.</p>
                        ) : (
                            filteredMedications.map(medication => (
                                <MedicationItem
                                    key={medication.id}
                                    medication={medication}
                                    onToggleStatus={toggleMedicationStatus}
                                    onDelete={deleteMedication}
                                />
                            ))
                        )}
                    </div>
                </div>
            );
        }
        
        // 5. BONUS: MEDICATION TRACKER WITH REDUCER
        // Reducer function for medication state management
        function medicationsReducer(state, action) {
            switch (action.type) {
                case 'ADD_MEDICATION':
                    return {
                        ...state,
                        medications: [...state.medications, action.payload]
                    };
                
                case 'TOGGLE_STATUS':
                    return {
                        ...state,
                        medications: state.medications.map(med => {
                            if (med.id === action.payload) {
                                return {
                                    ...med,
                                    isActive: !med.isActive,
                                    lastTaken: !med.isActive ? null : new Date().toISOString()
                                };
                            }
                            return med;
                        })
                    };
                
                case 'DELETE_MEDICATION':
                    return {
                        ...state,
                        medications: state.medications.filter(med => med.id !== action.payload)
                    };
                
                case 'SET_FILTER':
                    return {
                        ...state,
                        filter: action.payload
                    };
                
                default:
                    return state;
            }
        }

        function MedicationTrackerWithReducer() {
            // Initial state
            const initialState = {
                medications: [
                    {
                        id: '1',
                        name: 'Lisinopril',
                        dosage: '10mg',
                        schedule: 'Daily',
                        isActive: true,
                        lastTaken: null
                    },
                    {
                        id: '2',
                        name: 'Metformin',
                        dosage: '500mg',
                        schedule: 'Twice daily',
                        isActive: true,
                        lastTaken: null
                    },
                    {
                        id: '3',
                        name: 'Vitamin D',
                        dosage: '1000 IU',
                        schedule: 'Daily',
                        isActive: false,
                        lastTaken: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() // 1 day ago
                    }
                ],
                filter: 'all'
            };
            
            // Use reducer
            const [state, dispatch] = useReducer(medicationsReducer, initialState);
            const { medications, filter } = state;
            
            // Add a new medication
            const addMedication = (medication) => {
                dispatch({ type: 'ADD_MEDICATION', payload: medication });
            };
            
            // Delete confirmation
            const handleDelete = (id) => {
                if (confirm('Are you sure you want to delete this medication?')) {
                    dispatch({ type: 'DELETE_MEDICATION', payload: id });
                }
            };
            
            // Get filtered medications
            const getFilteredMedications = () => {
                switch (filter) {
                    case 'active':
                        return medications.filter(med => med.isActive);
                    case 'taken':
                        return medications.filter(med => !med.isActive);
                    default:
                        return medications;
                }
            };
            
            const filteredMedications = getFilteredMedications();
            
            return (
                <div className="container">
                    <h1>Medication Tracker (with useReducer)</h1>
                    
                    <div className="instructions">
                        <h3>Exercise: Medication Tracker with State (Completed with useReducer)</h3>
                        <p>This version demonstrates state management in React using the useReducer hook.</p>
                        <p>Key benefits of useReducer:</p>
                        <ul>
                            <li>Centralized state logic</li>
                            <li>More structured state updates</li>
                            <li>Better handling of complex state transitions</li>
                            <li>Easier to test and debug</li>
                        </ul>
                    </div>
                    
                    <MedicationForm onAddMedication={addMedication} />
                    
                    <h2>Your Medications</h2>
                    <FilterControls 
                        activeFilter={filter} 
                        onFilterChange={(newFilter) => 
                            dispatch({ type: 'SET_FILTER', payload: newFilter })
                        } 
                    />
                    
                    <div className="medication-list">
                        {filteredMedications.length === 0 ? (
                            <p>No medications found.</p>
                        ) : (
                            filteredMedications.map(medication => (
                                <MedicationItem
                                    key={medication.id}
                                    medication={medication}
                                    onToggleStatus={(id) => 
                                        dispatch({ type: 'TOGGLE_STATUS', payload: id })
                                    }
                                    onDelete={handleDelete}
                                />
                            ))
                        )}
                    </div>
                </div>
            );
        }
        
        // Component to show both versions with tabs
        function App() {
            const [activeTab, setActiveTab] = useState('useState');
            
            return (
                <div>
                    <ul className="tabs">
                        <li 
                            className={activeTab === 'useState' ? 'active' : ''}
                            onClick={() => setActiveTab('useState')}
                        >
                            useState Version
                        </li>
                        <li 
                            className={activeTab === 'useReducer' ? 'active' : ''}
                            onClick={() => setActiveTab('useReducer')}
                        >
                            useReducer Version
                        </li>
                    </ul>
                    
                    {activeTab === 'useState' ? (
                        <MedicationTracker />
                    ) : (
                        <MedicationTrackerWithReducer />
                    )}
                </div>
            );
        }
        
        // Render the app
        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);
    </script>
</body>
</html> 